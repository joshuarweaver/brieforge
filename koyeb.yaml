services:
  - name: fieldcraft-api
    type: web
    instance_profile: nano
    regions:
      - fra
    ports:
      - name: http
        port: 8000
        protocol: http
    routes:
      - path: /
        port: http
    env:
      - key: PORT
        value: "8000"
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: "0"
      - key: DATABASE_URL
        secret: fieldcraft-database-url
      - key: SECRET_KEY
        secret: fieldcraft-secret-key
      - key: ANTHROPIC_API_KEY
        secret: fieldcraft-anthropic-api-key
      - key: OPENAI_API_KEY
        secret: fieldcraft-openai-api-key
      - key: SEARCHAPI_KEY
        secret: fieldcraft-searchapi-key
    checks:
      - name: http-health
        type: http
        path: /health
        interval: 30
        timeout: 5
    source:
      type: git
      git:
        repo: https://github.com/your-org/brieforge.git
        branch: main
      dockerfile: Dockerfile
      workdir: .
